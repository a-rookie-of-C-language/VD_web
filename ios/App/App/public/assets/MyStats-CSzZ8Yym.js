import{d as j,u as G,r as y,o as H,c as g,y as J,k as E,K as $,i as t,e,l as o,w as s,f as c,n as K,E as A,h as v,J as Q,t as l,m as d,Q as q,R as L,S as O,B as W,C as X,G as Y,I as Z,T as tt,F as et,j as st,U as at,H as b,b as it,P as ot,_ as lt}from"./index-BpHSPl7m.js";const nt={class:"my-stats-page"},ct={class:"user-info-content"},dt={class:"user-avatar"},rt={class:"user-details"},ut={class:"user-name"},_t={class:"user-id"},vt={class:"user-actions"},pt={class:"stats-container"},ft={class:"stat-card duration-card"},mt={class:"stat-icon"},ht={class:"stat-info"},yt={class:"stat-value"},gt={class:"stat-card activity-card"},bt={class:"stat-icon"},wt={class:"stat-info"},xt={class:"stat-value"},St={class:"card-header"},kt={class:"header-title"},Tt={class:"hidden-xs-only"},Ct={class:"activity-name"},Nt={class:"duration-text"},Dt={class:"time-cell"},zt={class:"empty-state"},Bt={class:"visible-xs-only mobile-activity-list"},Et={class:"item-header"},$t={class:"item-title"},At={class:"item-body"},Lt={class:"item-row"},Mt={class:"item-row highlight-text"},Vt={class:"ml-1"},Rt={class:"item-row time-text"},Ft={key:0,class:"empty-mobile-text"},It=j({__name:"MyStats",setup(Ut){const u=G(),M=it(),w=y(!1),f=y([]),S=y(0),k=y(0),V=async()=>{if(u.studentNo.value){w.value=!0;try{const n=await K.fetchMyStatus();f.value=n.activities||[],S.value=n.totalDuration||0,k.value=n.totalActivities||0}catch(n){console.error(n),A.error("加载我的志愿数据失败")}finally{w.value=!1}}},R=async()=>{try{await ot.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),u.clearUser(),A.success("已退出登录"),M.push("/login")}catch{}},T=n=>{switch(n){case b.EnrollmentStarted:return"success";case b.ActivityStarted:return"warning";case b.ActivityEnded:return"info";case b.FailReview:return"danger";default:return""}},C=Z,N=Y,D=(n,i)=>{const x=new Date(n),p=new Date(i),m=x.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/\//g,"-"),r=p.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/\//g,"-");return`${m} ~ ${r}`};return H(()=>{u.studentNo.value&&V()}),(n,i)=>{const x=c("el-avatar"),p=c("el-button"),m=c("el-card"),r=c("el-icon"),z=c("el-col"),F=c("el-row"),_=c("el-table-column"),h=c("el-tag"),B=c("el-empty"),I=c("el-table"),U=X("loading");return v(),g("div",nt,[i[8]||(i[8]=J('<div class="page-header" data-v-a06f8acd><div class="header-content" data-v-a06f8acd><h1 class="title" data-v-a06f8acd>我的志愿概览</h1><p class="subtitle" data-v-a06f8acd>每一份奉献都值得被铭记，感谢您的付出！</p></div><div class="header-decoration" data-v-a06f8acd><div class="circle circle-1" data-v-a06f8acd></div><div class="circle circle-2" data-v-a06f8acd></div></div></div>',1)),o(u).isLoggedIn?(v(),E(m,{key:0,class:"user-info-card mb-4",shadow:"hover"},{default:s(()=>[t("div",ct,[t("div",dt,[e(x,{size:60,icon:o(Q),class:"avatar-icon"},null,8,["icon"])]),t("div",rt,[t("div",ut,l(o(u).username),1),t("div",_t,"学号: "+l(o(u).studentNo),1)]),t("div",vt,[e(p,{type:"danger",plain:"",round:"",icon:o(q),onClick:R,size:"small"},{default:s(()=>[...i[0]||(i[0]=[d("退出登录",-1)])]),_:1},8,["icon"])])])]),_:1})):$("",!0),t("div",pt,[e(F,{gutter:24},{default:s(()=>[e(z,{span:12,xs:24},{default:s(()=>[t("div",ft,[t("div",mt,[e(r,null,{default:s(()=>[e(o(L))]),_:1})]),t("div",ht,[t("div",yt,[d(l(S.value)+" ",1),i[1]||(i[1]=t("span",{class:"unit"},"小时",-1))]),i[2]||(i[2]=t("div",{class:"stat-label"},"累计志愿时长",-1))])])]),_:1}),e(z,{span:12,xs:24},{default:s(()=>[t("div",gt,[t("div",bt,[e(r,null,{default:s(()=>[e(o(O))]),_:1})]),t("div",wt,[t("div",xt,[d(l(k.value)+" ",1),i[3]||(i[3]=t("span",{class:"unit"},"次",-1))]),i[4]||(i[4]=t("div",{class:"stat-label"},"参与活动总数",-1))])])]),_:1})]),_:1})]),e(m,{class:"list-card",shadow:"hover"},{header:s(()=>[t("div",St,[t("div",kt,[e(r,null,{default:s(()=>[e(o(at))]),_:1}),i[5]||(i[5]=t("span",null,"近期参与记录",-1))])])]),default:s(()=>[t("div",Tt,[W((v(),E(I,{data:f.value,style:{width:"100%"},"header-cell-style":{background:"#f5f7fa",color:"#606266"},stripe:""},{empty:s(()=>[t("div",zt,[e(B,{description:"暂无参与记录，快去报名活动吧！"})])]),default:s(()=>[e(_,{prop:"name",label:"活动名称","min-width":"200"},{default:s(({row:a})=>[t("span",Ct,l(a.name),1)]),_:1}),e(_,{prop:"type",label:"类型",width:"140"},{default:s(({row:a})=>[e(h,{effect:"plain",round:""},{default:s(()=>[d(l(o(N)(a.type)),1)]),_:2},1024)]),_:1}),e(_,{prop:"duration",label:"时长",width:"120"},{default:s(({row:a})=>[t("span",Nt,l(a.duration)+" 小时",1)]),_:1}),e(_,{label:"活动时间","min-width":"320"},{default:s(({row:a})=>[t("div",Dt,[t("span",null,l(D(a.startTime,a.expectedEndTime)),1)])]),_:1}),e(_,{prop:"status",label:"状态",width:"120"},{default:s(({row:a})=>[e(h,{type:T(a.status),effect:"dark",size:"small"},{default:s(()=>[d(l(o(C)(a.status)),1)]),_:2},1032,["type"])]),_:1}),e(_,{fixed:"right",label:"操作",width:"100"},{default:s(({row:a})=>[e(p,{link:"",type:"primary",onClick:P=>n.$router.push(`/activity/${a.id}`)},{default:s(()=>[i[6]||(i[6]=d(" 查看 ",-1)),e(r,{class:"el-icon--right"},{default:s(()=>[e(o(tt))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[U,w.value]])]),t("div",Bt,[(v(!0),g(et,null,st(f.value,a=>(v(),g("div",{key:a.id,class:"mobile-activity-item"},[t("div",Et,[t("span",$t,l(a.name),1),e(p,{link:"",type:"primary",size:"small",onClick:P=>n.$router.push(`/activity/${a.id}`)},{default:s(()=>[...i[7]||(i[7]=[d("查看",-1)])]),_:1},8,["onClick"])]),t("div",At,[t("div",Lt,[e(h,{size:"small",effect:"plain"},{default:s(()=>[d(l(o(N)(a.type)),1)]),_:2},1024),e(h,{type:T(a.status),size:"small",class:"ml-2",effect:"dark"},{default:s(()=>[d(l(o(C)(a.status)),1)]),_:2},1032,["type"])]),t("div",Mt,[e(r,null,{default:s(()=>[e(o(L))]),_:1}),t("span",Vt,l(a.duration)+" 小时",1)]),t("div",Rt,l(D(a.startTime,a.expectedEndTime)),1)])]))),128)),f.value.length===0?(v(),g("div",Ft,[e(B,{description:"暂无参与记录"})])):$("",!0)])]),_:1})])}}}),jt=lt(It,[["__scopeId","data-v-a06f8acd"]]);export{jt as default};
